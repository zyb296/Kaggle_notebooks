# 训练集和测试集分布不一致

##### 参考：

- [训练/测试集分布不一致解法总结](https://zhuanlan.zhihu.com/p/368073953)
- 

## 一、发生原因

- 协变量偏移(Covariate Shift): 独立变量的偏移，指训练集和测试集的输入服从不同分布，但背后是服从同一个函数关系
- 先验概率偏移(Prior Probability Shift): 目标变量的偏移
- 概念偏移(Concept Shift): 独立变量和目标变量之间关系的偏移

## 二、判断方法

#### 1. KDE（核密度估计）分布图

#### 2.KS检验

#### 3.对抗验证

- [代码](https://github.com/Qiuyan918/Adversarial_Validation_Case_Study/blob/master/Adversarial_Validation.ipynb)
- [Adversarial validation, part one](http://fastml.com/adversarial-validation-part-one/)
- 

## 三、解决方法

### 1. 对抗验证 Adversarial validation

#### 1.1 原理

通过给测试集和训练集添加标签，用分类器进行训练，然后对训练集进行预测，将预测结果概率最大的前N个样本作为验证集。

#### 1.2 代码

```python
def adversarial_validation(df_train, df_test, class_model, validation_size=0.3):
  """
  Input：训练集，测试集，分类器
  Return：验证集，训练集的预测概率
  """
  pass
```



### 2. 有权重的交叉验证

#### 2.1 原理

通过分类器得到训练集的权重，将每个样本的权重输入到LGB模型中

#### 2.2 代码
